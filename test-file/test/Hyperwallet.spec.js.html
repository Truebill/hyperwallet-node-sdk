<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">test/Hyperwallet.spec.js | Hyperwallet REST SDK API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a data-ice="repoURL" href="https://github.com/hyperwallet/rest-v3-node-sdk.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Hyperwallet.js~Hyperwallet.html">Hyperwallet</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/ApiClient.js~ApiClient.html">ApiClient</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-api-callback">api-callback</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">test/Hyperwallet.spec.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import chai, { expect } from &quot;chai&quot;;
import dirtyChai from &quot;dirty-chai&quot;;
import sinon from &quot;sinon&quot;;
import sinonChai from &quot;sinon-chai&quot;;

import Hyperwallet from &quot;../src/Hyperwallet&quot;;

chai.should();
chai.use(dirtyChai);
chai.use(sinonChai);

/** @test {Hyperwallet} */
describe(&quot;Hyperwallet&quot;, () =&gt; {
    /** @test {Hyperwallet#constructor} */
    describe(&quot;constructor()&quot;, () =&gt; {
        /** @test {Hyperwallet#constructor} */
        it(&quot;should initialize ApiClient with default server&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            client.client.username.should.be.equal(&quot;test-username&quot;);
            client.client.password.should.be.equal(&quot;test-password&quot;);
            client.client.server.should.be.equal(&quot;https://api.sandbox.hyperwallet.com&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should set programToken to undefined if not provided&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            expect(client.programToken).to.be.undefined();
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should set programToken if provided&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                programToken: &quot;test-program-token&quot;,
            });

            client.programToken.should.be.equal(&quot;test-program-token&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should initialize ApiClient with provided server&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                server: &quot;test-server&quot;,
            });

            client.client.server.should.be.equal(&quot;test-server&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should throw error if username is missing&quot;, () =&gt; {
            expect(() =&gt; new Hyperwallet({
                password: &quot;test-password&quot;,
            })).to.throw(&quot;You need to specify your API username and password!&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should throw error if password is missing&quot;, () =&gt; {
            expect(() =&gt; new Hyperwallet({
                username: &quot;test-username&quot;,
            })).to.throw(&quot;You need to specify your API username and password!&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should throw error if username and password is missing&quot;, () =&gt; {
            expect(() =&gt; new Hyperwallet({
            })).to.throw(&quot;You need to specify your API username and password!&quot;);
        });
    });

    //--------------------------------------
    // TLS verification
    //--------------------------------------

    describe(&quot;listUsers()&quot;, () =&gt; {
        it(&quot;should not have any TLS issues&quot;, (cb) =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.listUsers({}, (err, body, res) =&gt; {
                res.status.should.be.equal(401);
                cb();
            });
        });
    });

    //--------------------------------------
    // Users
    //--------------------------------------

    /** @test {Hyperwallet#createUser} */
    describe(&quot;createUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createUser} */
        it(&quot;should do post call to users endpoint without programToken added&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createUser({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });

        /** @test {Hyperwallet#createUser} */
        it(&quot;should do post call to users endpoint with programToken added&quot;, () =&gt; {
            client.programToken = &quot;test-program-token&quot;;

            const callback = () =&gt; null;
            client.createUser({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {
                test: &quot;value&quot;,
                programToken: &quot;test-program-token&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getUser} */
    describe(&quot;getUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getUser} */
        it(&quot;should do get call if userToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updateUser} */
    describe(&quot;updateUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateUser(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateUser} */
        it(&quot;should do put call to users endpoint without programToken added&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateUser(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });

        /** @test {Hyperwallet#updateUser} */
        it(&quot;should do put call to users endpoint with programToken added&quot;, () =&gt; {
            client.programToken = &quot;test-program-token&quot;;

            const callback = () =&gt; null;
            client.updateUser(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token&quot;, {
                test: &quot;value&quot;,
                programToken: &quot;test-program-token&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listUsers} */
    describe(&quot;listUsers()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listUsers} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listUsers({ test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listUsers} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listUsers({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {});
        });

        /** @test {Hyperwallet#listUsers} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listUsers({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Prepaid Cards
    //--------------------------------------

    /** @test {Hyperwallet#createPrepaidCard} */
    describe(&quot;createPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPrepaidCard(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPrepaidCard} */
        it(&quot;should do post call to prepaid cards endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPrepaidCard(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPrepaidCard} */
    describe(&quot;getPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCard(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCard(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCard} */
        it(&quot;should do get call if userToken and prepaidCardToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updatePrepaidCard} */
    describe(&quot;updatePrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updatePrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePrepaidCard(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePrepaidCard(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePrepaidCard} */
        it(&quot;should do put call to prepaid cards endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updatePrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPrepaidCards} */
    describe(&quot;listPrepaidCards()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCards(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPrepaidCards(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPrepaidCards(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, {});
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listPrepaidCards(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    const PREPAID_CARD_STATUS_CHANGE_METHODS = {
        suspend: &quot;SUSPENDED&quot;,
        unsuspend: &quot;UNSUSPENDED&quot;,
        lostOrStolen: &quot;LOST_OR_STOLEN&quot;,
        deactivate: &quot;DE_ACTIVATED&quot;,
        lock: &quot;LOCKED&quot;,
        unlock: &quot;UNLOCKED&quot;,
    };
    Object.keys(PREPAID_CARD_STATUS_CHANGE_METHODS).forEach((method) =&gt; {
        const methodName = `${method}PrepaidCard`;

        describe(`${methodName}()`, () =&gt; {
            let client;
            let apiClientSpy;

            beforeEach(() =&gt; {
                apiClientSpy = sinon.spy();
                client = new Hyperwallet({
                    username: &quot;test-username&quot;,
                    password: &quot;test-password&quot;,
                });
                client.client = {
                    doPost: apiClientSpy,
                };
            });

            /**
             * @test {Hyperwallet#suspendPrepaidCard}
             * @test {Hyperwallet#unsuspendPrepaidCard}
             * @test {Hyperwallet#lostOrStolenPrepaidCard}
             * @test {Hyperwallet#deactivatePrepaidCard}
             * @test {Hyperwallet#lockPrepaidCard}
             * @test {Hyperwallet#unlockPrepaidCard}
             */
            it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
                const callback = () =&gt; null;
                expect(() =&gt; client[methodName](undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
            });

            /**
             * @test {Hyperwallet#suspendPrepaidCard}
             * @test {Hyperwallet#unsuspendPrepaidCard}
             * @test {Hyperwallet#lostOrStolenPrepaidCard}
             * @test {Hyperwallet#deactivatePrepaidCard}
             * @test {Hyperwallet#lockPrepaidCard}
             * @test {Hyperwallet#unlockPrepaidCard}
             */
            it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
                const callback = () =&gt; null;
                expect(() =&gt; client[methodName](&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
            });

            /**
             * @test {Hyperwallet#suspendPrepaidCard}
             * @test {Hyperwallet#unsuspendPrepaidCard}
             * @test {Hyperwallet#lostOrStolenPrepaidCard}
             * @test {Hyperwallet#deactivatePrepaidCard}
             * @test {Hyperwallet#lockPrepaidCard}
             * @test {Hyperwallet#unlockPrepaidCard}
             */
            it(`should send transition to &apos;${PREPAID_CARD_STATUS_CHANGE_METHODS[method]}&apos;`, () =&gt; {
                const callback = () =&gt; null;
                client[methodName](&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, callback);

                apiClientSpy.should.have.been.calledOnce();
                apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {
                    transition: PREPAID_CARD_STATUS_CHANGE_METHODS[method],
                }, {}, callback);
            });
        });
    });

    /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
    describe(&quot;createPrepaidCardStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPrepaidCardStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPrepaidCardStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
        it(&quot;should send post call to prepaid card status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPrepaidCardStatusTransition(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
    describe(&quot;getPrepaidCardStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCardStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCardStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCardStatusTransition(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should do get call if userToken, prepaidCardToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPrepaidCardStatusTransition(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
    describe(&quot;listPrepaidCardStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCardStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Bank Accounts
    //--------------------------------------

    /** @test {Hyperwallet#createBankAccount} */
    describe(&quot;createBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankAccount(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankAccount} */
        it(&quot;should do post call to bank accounts endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBankAccount(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getBankAccount} */
    describe(&quot;getBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccount} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccount} */
        it(&quot;should do get call if userToken and bankAccountToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getBankAccount(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updateBankAccount} */
    describe(&quot;updateBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBankAccount(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBankAccount} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBankAccount(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBankAccount} */
        it(&quot;should do put call to bank accounts endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateBankAccount(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBankAccounts} */
    describe(&quot;listBankAccounts()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccounts(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankAccounts(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankAccounts(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, {});
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listBankAccounts(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#deactivateBankAccount} */
    describe(&quot;deactivateBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#deactivateBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBankAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateBankAccount} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBankAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateBankAccount} */
        it(&quot;should send transition to &apos;DE-ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivateBankAccount(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {
                transition: &quot;DE-ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createBankAccountStatusTransition} */
    describe(&quot;createBankAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBankAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankAccountStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankAccountStatusTransition} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankAccountStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankAccountStatusTransition} */
        it(&quot;should send post call to prepaid card status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBankAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBankAccountStatusTransitions} */
    describe(&quot;listBankAccountStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccountStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Balances
    //--------------------------------------

    /** @test {Hyperwallet#listBalancesForUser} */
    describe(&quot;listBalancesForUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForUser(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForUser(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/balances&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/balances&quot;, {});
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listBalancesForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/balances&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listBalancesForPrepaidCard} */
    describe(&quot;listBalancesForPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForPrepaidCard(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/balances&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/balances&quot;, {});
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/balances&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listBalancesForAccount} */
    describe(&quot;listBalancesForAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForAccount(undefined, undefined, {}, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should throw error if accountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForAccount(&quot;test-program-token&quot;, undefined, {}, callback)).to.throw(&quot;accountToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/balances&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/balances&quot;, {});
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/balances&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Payments
    //--------------------------------------

    /** @test {Hyperwallet#createPayment} */
    describe(&quot;createPayment()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPayment} */
        it(&quot;should do post call to payments endpoint without programToken added&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPayment({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });

        /** @test {Hyperwallet#createPayment} */
        it(&quot;should do post call to payments endpoint with programToken added&quot;, () =&gt; {
            client.programToken = &quot;test-program-token&quot;;

            const callback = () =&gt; null;
            client.createPayment({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {
                test: &quot;value&quot;,
                programToken: &quot;test-program-token&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPayment} */
    describe(&quot;getPayment()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPayment} */
        it(&quot;should throw error if paymentToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayment(undefined, callback)).to.throw(&quot;paymentToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayment} */
        it(&quot;should do get call if paymentToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPayment(&quot;test-payment-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPayments} */
    describe(&quot;listPayments()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPayments({ test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPayments({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {});
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listPayments({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Programs
    //--------------------------------------

    /** @test {Hyperwallet#getProgram} */
    describe(&quot;getProgram()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getProgram} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getProgram(undefined, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#getProgram} */
        it(&quot;should do get call if programToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getProgram(&quot;test-program-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token&quot;, {}, callback);
        });
    });

    //--------------------------------------
    // Program Accounts
    //--------------------------------------

    /** @test {Hyperwallet#getProgramAccount} */
    describe(&quot;getProgramAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getProgramAccount} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getProgramAccount(undefined, undefined, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#getProgramAccount} */
        it(&quot;should throw error if accountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getProgramAccount(&quot;test-program-token&quot;, undefined, callback)).to.throw(&quot;accountToken is required&quot;);
        });

        /** @test {Hyperwallet#getProgramAccount} */
        it(&quot;should do get call if programToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token&quot;, {}, callback);
        });
    });

    //--------------------------------------
    // Transfer Method Configurations
    //--------------------------------------

    /** @test {Hyperwallet#getTransferMethodConfiguration} */
    describe(&quot;getTransferMethodConfiguration()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(undefined, undefined, undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if country is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, undefined, undefined, undefined, undefined, callback)).to.throw(&quot;country is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if currency is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, undefined, undefined, undefined, callback)).to.throw(&quot;currency is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if type is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, &quot;test-currency&quot;, undefined, undefined, callback)).to.throw(&quot;type is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if profileType is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, &quot;test-currency&quot;, &quot;test-type&quot;, undefined, callback)).to.throw(&quot;profileType is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should do get call if userToken, country, currency, type and profileType is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, &quot;test-currency&quot;, &quot;test-type&quot;, &quot;test-profile-type&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                userToken: &quot;test-user-token&quot;,
                country: &quot;test-country&quot;,
                currency: &quot;test-currency&quot;,
                type: &quot;test-type&quot;,
                profileType: &quot;test-profile-type&quot;,
            }, callback);
        });
    });

    /** @test {Hyperwallet#listTransferMethodConfigurations} */
    describe(&quot;listTransferMethodConfigurations()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferMethodConfigurations(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferMethodConfigurations(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                test: &quot;value&quot;,
                userToken: &quot;test-user-token&quot;,
            });
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferMethodConfigurations(&quot;test-user-token&quot;, undefined, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                userToken: &quot;test-user-token&quot;,
            });
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listTransferMethodConfigurations(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                userToken: &quot;test-user-token&quot;,
            });

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    describe(&quot;createTransferMethod()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createTransferMethod} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            const userToken = null;
            const cacheToken = null;

            expect(() =&gt; client.createTransferMethod(userToken, cacheToken, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransferMethod} */
        it(&quot;should throw error if cacheToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            const userToken = &quot;test-user-token&quot;;
            const cacheToken = null;

            expect(() =&gt; client.createTransferMethod(userToken, cacheToken, callback)).to.throw(&quot;jsonCacheToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransferMethod} */
        it(&quot;should do post call with userToken and cacheToken&quot;, () =&gt; {
            const callback = () =&gt; null;
            const userToken = &quot;test-user-token&quot;;
            const cacheToken = &quot;test-cache-token&quot;;
            client.createTransferMethod(userToken, cacheToken, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/transfer-methods&quot;, { test: &quot;value&quot; }, { &quot;Json-Cache-Token&quot;: &quot;test-cache-token&quot; });
        });
    });

    //--------------------------------------
    // Receipts
    //--------------------------------------

    /** @test {Hyperwallet#listReceiptsForProgramAccount} */
    describe(&quot;listReceiptsForProgramAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForProgramAccount(undefined, undefined, {}, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should throw error if accountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, undefined, {}, callback)).to.throw(&quot;accountToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/receipts&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/receipts&quot;, {});
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/receipts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listReceiptsForUser} */
    describe(&quot;listReceiptsForUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForUser(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForUser(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/receipts&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/receipts&quot;, {});
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listReceiptsForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/receipts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
    describe(&quot;listReceiptsForPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForPrepaidCard(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/receipts&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/receipts&quot;, {});
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/receipts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Webhooks
    //--------------------------------------

    describe(&quot;listWebhookNotifications()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listWebhookNotifications({ test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listWebhookNotifications({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications&quot;, {});
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });

                cb();
            };
            client.listWebhookNotifications({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    describe(&quot;getWebhookNotification&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getWebhookNotification} */
        it(&quot;should throw error if webhookToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getWebhookNotification(undefined, {}, callback)).to.throw(&quot;webhookToken is required&quot;);
        });

        /** @test {Hyperwallet#getWebhookNotification} */
        it(&quot;should do get call if webhookToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getWebhookNotification(&quot;webhook-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications/webhook-token&quot;, {}, callback);
        });
    });

    //--------------------------------------
    // Internal utils
    //--------------------------------------

    describe(&quot;addProgramToken()&quot;, () =&gt; {
        it(&quot;should do nothing if no data is provided&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            expect(client.addProgramToken()).to.be.undefined();
        });

        it(&quot;should do nothing if no programToken is set&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            client.addProgramToken({ test: &quot;value&quot; }).should.be.deep.equal({ test: &quot;value&quot; });
        });

        it(&quot;should do nothing if programToken is set in data&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                programToken: &quot;test-program-token&quot;,
            });

            client.addProgramToken({ test: &quot;value&quot;, programToken: &quot;my-program-token&quot; }).should.be.deep.equal({ test: &quot;value&quot;, programToken: &quot;my-program-token&quot; });
        });

        it(&quot;should add programToken if no programToken is set in data&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                programToken: &quot;test-program-token&quot;,
            });

            client.addProgramToken({ test: &quot;value&quot; }).should.be.deep.equal({ test: &quot;value&quot;, programToken: &quot;test-program-token&quot; });
        });
    });

    describe(&quot;handle204Response()&quot;, () =&gt; {
        it(&quot;should return a &apos;function&apos; with a argument&quot;, () =&gt; {
            Hyperwallet.handle204Response(() =&gt; null).should.be.a(&quot;function&quot;);
        });

        it(&quot;should do nothing for errors&quot;, (cb) =&gt; {
            const providedErr = new Error(&quot;Test&quot;);
            const providedData = {
                test: &quot;value&quot;,
            };
            const providedRes = {
                status: 200,
            };

            const callback = Hyperwallet.handle204Response((err, data, res) =&gt; {
                err.should.be.deep.equal(providedErr);
                data.should.be.deep.equal(providedData);
                res.should.be.deep.equal(providedRes);

                cb();
            });
            callback(providedErr, providedData, providedRes);
        });

        it(&quot;should do nothing for non 204 responses&quot;, (cb) =&gt; {
            const providedData = {
                test: &quot;value&quot;,
            };
            const providedRes = {
                status: 200,
            };

            const callback = Hyperwallet.handle204Response((err, data, res) =&gt; {
                expect(err).to.be.undefined();

                data.should.be.deep.equal(providedData);
                res.should.be.deep.equal(providedRes);

                cb();
            });
            callback(undefined, providedData, providedRes);
        });

        it(&quot;should return empty list for 204 responses&quot;, (cb) =&gt; {
            const providedData = {
                test: &quot;value&quot;,
            };
            const providedRes = {
                status: 204,
            };

            const callback = Hyperwallet.handle204Response((err, data, res) =&gt; {
                expect(err).to.be.undefined();

                data.should.be.deep.equal({
                    count: 0,
                    data: [],
                });
                res.should.be.deep.equal(providedRes);

                cb();
            });
            callback(undefined, providedData, providedRes);
        });
    });
});
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.8)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
